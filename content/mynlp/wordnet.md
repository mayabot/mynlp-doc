---
title: "Wordnet和Wordpath"
draft: false
---
## Wordnet和Wordpath

**Wordnet**

中文分词之所以复杂，根本原因在于存在多种切分可能性，算法需要选择一个最佳的切分路径。比如"商品和服务"，"商品/和服/务"就是其中一个
错误的切分路径。

mynlp把分词过程总结为个部分，一、分词算法负责找出各种分词路径。二、选择一种分词路径。

Wordnet是一种表达多个分词可能路径的数据结构,这个数据结构也在hanlp、ansj中使用。在mynlp中我们实行了特殊的链表，
使得Wordnet非常高效，产生很少的临时对象。

词图(wordnet)是描述一个文本所有分词可能路径的分词结构。

![词图篱笆网络](images/wordnet-g.png)

不难理解，站在每个字的角度来看，会有一个或多个跳转路径。从Start节点到End节点中必定存在一个最优路径，这个路径就是
分词结果了。

但是上图如果利用Node和Edge的数据结构来表达的话，性能和方便程度都会有各种问题。

所以我们用如下这个结构：

![Wordnet](images/wordnet.png)
每个数字节点，表示一个边，也表示从当前这个字构成的词的长度。

对应的Java数据为：
![Wordnet Data](images/wordnet-ds.png)
每个字对应一个VertexRow,每个VertexRow指向一个Vertex链表，其中Vertex链表中的数字大小一定是不可重复且有序的。

在任何的分词算法中，第一步总是需要填充Wordnet，给出一个或多个分词路径的可能性。如果是基于核心词典的，那么
就根据词典匹配来填充，如是基于CRF、感知机也可以来填充出唯一一个路径。当然也可以有基于规则的，比如数字、产品编号、时间
等。

**wordpath**

Wordnet是表达一段文本的多个分词可能性的路径，所以必定是篱笆网络的形式。那么如何表达由算法选择出来的一个路径呢？
其他分词器实现中，大部分采用List的结构。如果路径不在变化，那么也就无所谓，但是在实际过程中，还需要对这个
**唯一的路径再进行修改**，就会涉及到很多`联合`、`打破-再联合`等操作，在List的基础上操作起来，代码非常复杂且
不容易理解。


这里我们使用BitSet来表示唯一分词路径。
![Wordpath](images/wordpath.png)
图中的字之间的斜线，表示要切断。我们用bitset中和字对应的Index，设置为true。
比如"提高"是一个词，那么设置bitset的下标1为true。

就是这么简单，使用这种数据结构的好处是，combine或者划词的操作非常简单，而且内存上消耗非常非常低。

wordpath和wordnet可进行双向关联，你在wordpath中划定一个词语后，对应的wordnet中也会创建对应的Vertex节点。
